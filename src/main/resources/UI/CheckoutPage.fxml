<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.scene.effect.*?>

<AnchorPane xmlns="http://javafx.com/javafx/25"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="Controllers.CheckoutController"
            prefWidth="1200" prefHeight="900"
            minWidth="800" minHeight="600"
            style="-fx-background-color: linear-gradient(to bottom, #12372A, #1a4d38);">

    <!-- Header Bar -->
    <HBox AnchorPane.topAnchor="0"
          AnchorPane.leftAnchor="0"
          AnchorPane.rightAnchor="0"
          alignment="CENTER_LEFT"
          spacing="20"
          style="-fx-background-color: rgba(255, 255, 255, 0.1); -fx-padding: 20 40;">
        <effect>
            <DropShadow radius="10" spread="0.1" color="#00000033"/>
        </effect>

        <!-- Back Button -->
        <Button text="â† Back"
                onAction="#backToMenu"
                style="-fx-background-color: transparent;
                       -fx-text-fill: #2E8B57;
                       -fx-font-size: 15;
                       -fx-font-weight: bold;
                       -fx-cursor: hand;
                       -fx-padding: 8 16;">
        </Button>

        <!-- Title -->
        <VBox spacing="2">
            <Text text="Checkout" fill="#1a1a1a">
                <font>
                    <Font name="System Bold" size="22"/>
                </font>
            </Text>
            <Text text="Review and complete your order" fill="#6b7280">
                <font>
                    <Font size="13"/>
                </font>
            </Text>
        </VBox>

        <Region HBox.hgrow="ALWAYS"/>

        <!-- User Balance Display -->
        <HBox alignment="CENTER" spacing="10"
              style="-fx-background-color: linear-gradient(to right, #2E8B57, #3ba869);
                     -fx-background-radius: 12;
                     -fx-padding: 12 20;">
            <effect>
                <DropShadow radius="8" color="#2E8B5733"/>
            </effect>

            <VBox alignment="CENTER_RIGHT" spacing="2">
                <Text text="Your Balance" fill="rgba(255, 255, 255, 0.8)">
                    <font>
                        <Font size="11"/>
                    </font>
                </Text>
                <Text fx:id="userBalanceText" text="0 Ft" fill="white">
                    <font>
                        <Font name="System Bold" size="20"/>
                    </font>
                </Text>
            </VBox>

            <Text text="ðŸ’³" fill="white">
                <font>
                    <Font size="24"/>
                </font>
            </Text>
        </HBox>
    </HBox>

    <!-- Main Content -->
    <HBox AnchorPane.topAnchor="100"
          AnchorPane.bottomAnchor="40"
          AnchorPane.leftAnchor="40"
          AnchorPane.rightAnchor="40"
          spacing="30">

        <!-- Left Side - Order Items -->
        <VBox spacing="20" HBox.hgrow="ALWAYS">

            <!-- Order Items Card -->
            <VBox spacing="15"
                  style="-fx-background-color: white;
                         -fx-background-radius: 16;
                         -fx-padding: 30;">
                <effect>
                    <DropShadow radius="15" spread="0.05" color="#00000010"/>
                </effect>

                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Text text="ðŸ›’" fill="#2E8B57">
                        <font>
                            <Font size="24"/>
                        </font>
                    </Text>
                    <Text text="Order Items" fill="#1a1a1a">
                        <font>
                            <Font name="System Bold" size="20"/>
                        </font>
                    </Text>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Text fx:id="itemCountText" text="0 items" fill="#6b7280">
                        <font>
                            <Font name="System Bold" size="14"/>
                        </font>
                    </Text>
                </HBox>

                <Separator style="-fx-background-color: #e5e7eb;"/>

                <!-- Scrollable Items -->
                <ScrollPane fitToWidth="true"
                            style="-fx-background: transparent;
                                   -fx-background-color: transparent;
                                   -fx-border-color: transparent;"
                            VBox.vgrow="ALWAYS"
                            prefViewportHeight="400"
                            minHeight="400">
                    <VBox fx:id="orderItemsContainer"
                          spacing="12"
                          style="-fx-background-color: transparent;">
                        <padding>
                            <Insets top="10" bottom="10"/>
                        </padding>
                    </VBox>
                </ScrollPane>

            </VBox>

        </VBox>

        <!-- Right Side - Order Summary -->
        <VBox spacing="20" prefWidth="400" minWidth="380">

            <!-- Summary Card -->
            <VBox spacing="25"
                  style="-fx-background-color: white;
                         -fx-background-radius: 16;
                         -fx-padding: 30;">
                <effect>
                    <DropShadow radius="15" spread="0.05" color="#00000010"/>
                </effect>

                <Text text="Order Summary" fill="#1a1a1a">
                    <font>
                        <Font name="System Bold" size="20"/>
                    </font>
                </Text>

                <VBox spacing="15">
                    <!-- Subtotal -->
                    <HBox alignment="CENTER">
                        <Text text="Subtotal" fill="#6b7280">
                            <font>
                                <Font size="15"/>
                            </font>
                        </Text>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Text fx:id="subtotalText" text="0 Ft" fill="#1a1a1a">
                            <font>
                                <Font name="System Bold" size="16"/>
                            </font>
                        </Text>
                    </HBox>

                    <!-- Tax -->
                    <HBox alignment="CENTER">
                        <Text text="Tax (10%)" fill="#6b7280">
                            <font>
                                <Font size="15"/>
                            </font>
                        </Text>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Text fx:id="taxText" text="0 Ft" fill="#1a1a1a">
                            <font>
                                <Font name="System Bold" size="16"/>
                            </font>
                        </Text>
                    </HBox>

                    <Separator style="-fx-background-color: #e5e7eb; -fx-padding: 5 0;"/>

                    <!-- Total -->
                    <HBox alignment="CENTER"
                          style="-fx-background-color: #f9fafb;
                                 -fx-background-radius: 10;
                                 -fx-padding: 15;">
                        <Text text="Total Amount" fill="#1a1a1a">
                            <font>
                                <Font name="System Bold" size="17"/>
                            </font>
                        </Text>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Text fx:id="totalText" text="0 Ft" fill="#2E8B57">
                            <font>
                                <Font name="System Bold" size="26"/>
                            </font>
                        </Text>
                    </HBox>
                </VBox>

                <!-- Action Buttons -->
                <VBox spacing="12">
                    <Button fx:id="confirmButton" text="Confirm Order"
                            onAction="#confirmOrder"
                            maxWidth="Infinity"
                            prefHeight="55"
                            style="-fx-background-color: linear-gradient(to right, #2E8B57, #3ba869);
                                   -fx-text-fill: white;
                                   -fx-background-radius: 12;
                                   -fx-font-size: 16;
                                   -fx-font-weight: bold;
                                   -fx-cursor: hand;">
                        <effect>
                            <DropShadow radius="10" color="#2E8B5744"/>
                        </effect>
                    </Button>

                    <Button text="Clear Order"
                            onAction="#clearOrder"
                            maxWidth="Infinity"
                            prefHeight="48"
                            style="-fx-background-color: #fee;
                                   -fx-text-fill: #dc3545;
                                   -fx-background-radius: 12;
                                   -fx-font-size: 15;
                                   -fx-font-weight: bold;
                                   -fx-border-color: #fcc;
                                   -fx-border-width: 1;
                                   -fx-border-radius: 12;
                                   -fx-cursor: hand;">
                    </Button>
                </VBox>

                <!-- Security Badge -->
                <HBox alignment="CENTER" spacing="8"
                      style="-fx-background-color: #f0fdf4;
                             -fx-background-radius: 8;
                             -fx-padding: 12;">
                    <Text text="ðŸ”’" fill="#2E8B57">
                        <font>
                            <Font size="16"/>
                        </font>
                    </Text>
                    <Text text="Secure checkout process" fill="#2E8B57">
                        <font>
                            <Font name="System Bold" size="12"/>
                        </font>
                    </Text>
                </HBox>

            </VBox>

        </VBox>

    </HBox>

</AnchorPane>